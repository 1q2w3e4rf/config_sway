#!/bin/bash
# =============================================
# –ú–û–ô –ö–†–£–¢–û–ô BASHRC –î–õ–Ø SWAY WM
# –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–º—Ñ–æ—Ä—Ç–∞ –≤ —Ä–∞–±–æ—Ç–µ
# –ê–≤—Ç–æ—Ä: 1q2w3e4rf
# –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 30.05.2025
# =============================================

# ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
# ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù
# ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë     
# ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë     
# ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
# ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

# üîß –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
export EDITOR=nvim               # –õ—é–±–ª—é Vim :)
export TERMINAL=konsole          # –¢–µ—Ä–º–∏–Ω–∞–ª –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
export BROWSER=yandex-browser    # –ú–æ–π –ª—é–±–∏–º—ã–π –±—Ä–∞—É–∑–µ—Ä

# üîÑ –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
if [ -f /usr/share/bash-completion/bash_completion ]; then
    source /usr/share/bash-completion/bash_completion
fi

# ========================
# üé® –ù–ê–°–¢–†–û–ô–ö–ê –ü–†–û–ú–ü–¢–ê
# ========================
set_prompt() {
    local EXIT=$?
    local COL_USER="\[\033[1;32m\]"   # –ó–µ–ª–µ–Ω—ã–π - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    local COL_HOST="\[\033[1;33m\]"   # –ñ–µ–ª—Ç—ã–π - —Ö–æ—Å—Ç
    local COL_DIR="\[\033[1;34m\]"    # –°–∏–Ω–∏–π - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
    local COL_RESET="\[\033[0m\]"     # –°–±—Ä–æ—Å —Ü–≤–µ—Ç–∞
    
    PS1="\n${COL_USER}\u${COL_RESET}@${COL_HOST}\h ${COL_DIR}\w\n"
    
    # –ö—Ä–∞—Å–Ω–∞—è —Å—Ç—Ä–µ–ª–∫–∞ –µ—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω—è—è –∫–æ–º–∞–Ω–¥–∞ —É–ø–∞–ª–∞
    if [ $EXIT -ne 0 ]; then
        PS1+="\[\033[1;31m\]‚ùØ${COL_RESET} "
    else
        PS1+="\[\033[1;32m\]‚ùØ${COL_RESET} "
    fi
}
PROMPT_COMMAND='set_prompt'

# ========================
# üöÄ –ê–õ–ò–ê–°–´ –ò –§–£–ù–ö–¶–ò–ò
# ========================

# üìÅ –§–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
alias ls='exa --group-directories-first'
alias ll='exa -lh --git --icons'
alias la='exa -a'
alias lla='exa -lha --git --icons'
alias rm='rm -i'                  # –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É—Ä–∞–∫–∞
alias cp='cp -i'
alias mv='mv -i'

# üñ• –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
alias update='sudo pacman -Syu && yay -Syu'    # –û–±–Ω–æ–≤–∏—Ç—å –≤—Å—ë
alias clean='sudo pacman -Rns $(pacman -Qtdq)' # –û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã
alias reboot='systemctl reboot'
alias off='systemctl poweroff'

# üéõ Sway WM —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ
alias sway-reload='swaymsg reload'             # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Sway
alias sway-restart='systemctl --user restart sway' # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Sway
alias screenshot='grim -g "$(slurp)" ~/Pictures/Screenshots/$(date +"%Y-%m-%d_%H-%M-%S").png' # –°–∫—Ä–∏–Ω—à–æ—Ç –æ–±–ª–∞—Å—Ç–∏

# üõ† –ü–æ–ª–µ–∑–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
mkcd() { mkdir -p "$1" && cd "$1"; }  # –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É –∏ –ø–µ—Ä–µ–π—Ç–∏ –≤ –Ω–µ—ë

# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—Ä—Ö–∏–≤–æ–≤
extract() {
    if [ -f "$1" ]; then
        case "$1" in
            *.tar.bz2) tar xjf "$1" ;;
            *.tar.gz)  tar xzf "$1" ;;
            *.zip)     unzip "$1" ;;
            *)         echo "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∞—Ä—Ö–∏–≤–∞" ;;
        esac
    else
        echo "–§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: $1"
    fi
}

# ========================
# üéõ –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –°–û SWAY
# ========================

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤ Wayland
export QT_QPA_PLATFORM=wayland
export GDK_BACKEND=wayland
export SDL_VIDEODRIVER=wayland
export CLUTTER_BACKEND=wayland
export MOZ_ENABLE_WAYLAND=1

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ GUI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ Sway
gui() {
    if [ -z "$WAYLAND_DISPLAY" ]; then
        echo "–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Sway! –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–∑ —Å–µ—Å—Å–∏–∏ Wayland"
        return 1
    fi
    
    case "$1" in
        browser)  yandex-browser --enable-features=UseOzonePlatform --ozone-platform=wayland ;;
        mail)     thunderbird ;;
        office)   onlyoffice-desktopeditors ;;
        *)        echo "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ" ;;
    esac
}

# ========================
# ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ê –°–ò–°–¢–ï–ú–´
# ========================

# –ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥
HISTSIZE=5000
HISTFILESIZE=10000
HISTCONTROL=ignoreboth  # –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥—É–±–ª–∏ –∏ –∫–æ–º–∞–Ω–¥—ã —Å –ø—Ä–æ–±–µ–ª–æ–º
shopt -s histappend     # –î–æ–±–∞–≤–ª—è—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—é, –∞ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å

# –£–¥–æ–±–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
shopt -s autocd         # –ü–µ—Ä–µ—Ö–æ–¥ –≤ –ø–∞–ø–∫—É –±–µ–∑ cd
shopt -s globstar       # –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ **
shopt -s nocaseglob     # –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞

# ========================
# üèÅ –ó–ê–ü–£–°–ö –ü–†–ò –°–¢–ê–†–¢–ï
# ========================

# –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
echo -e "\n\033[1;34m–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ \033[1;35mSway WM\033[0m"
echo -e "–¢–µ—Ä–º–∏–Ω–∞–ª: \033[1;32m$TERMINAL\033[0m"
echo -e "–†–µ–¥–∞–∫—Ç–æ—Ä: \033[1;33m$EDITOR\033[0m"
echo -e "–ë—Ä–∞—É–∑–µ—Ä: \033[1;36m$BROWSER\033[0m"
echo -e "\n–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:"
echo -e "  \033[1;37mupdate\033[0m - –û–±–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É"
echo -e "  \033[1;37msway-reload\033[0m - –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Sway"
echo -e "  \033[1;37mscreenshot\033[0m - –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç –æ–±–ª–∞—Å—Ç–∏\n"
